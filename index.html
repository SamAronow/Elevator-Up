<!DOCTYPE html>
<html>
<head>
  <title>Choose Player</title>
  <style>
    button {
      padding: 10px 20px;
      font-size: 18px;
      margin: 10px;
      cursor: pointer;
    }

    button.taken {
      background-color: #555;
      color: white;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>Select a Player</h1>
  <button id="player1-btn" onclick="selectPlayer(1)">Player 1</button>
  <button id="player2-btn" onclick="selectPlayer(2)">Player 2</button>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="database.js"></script>
  <script src="junk.js"></script>

  <script>

    function disableButton(playerNum) {
      const btn = document.getElementById(`player${playerNum}-btn`);
      btn.disabled = true;
      btn.classList.add("taken");
      btn.innerText = `Taken (Player ${playerNum})`;
    }

    firebase.database().ref("Player1/Used").on("value", snapshot => {
      if (snapshot.val() === true) {
        disableButton(1);
      }
    });

    firebase.database().ref("Player2/Used").on("value", snapshot => {
      if (snapshot.val() === true) {
        disableButton(2);
      }
    });

    function selectPlayer(num) {
      const usedPath = `Player${num}/Used`;

      read(usedPath).then(isUsed => {
        if (isUsed === true) {
          alert(`Player ${num} has already joined!`);
          return;
        }

        // Mark player as used and go to game page
        write(usedPath, true).then(() => {
          window.location.href = `game.html?player=${num}`;
        }).catch(error => {
          console.error("Write failed:", error);
        });
      });
    }
  </script>
</body>
</html>
